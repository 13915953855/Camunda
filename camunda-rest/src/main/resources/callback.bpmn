<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd">
  <bpmn2:process id="Process_3" isExecutable="true">
    <bpmn2:startEvent id="StartEvent_1">
      <bpmn2:outgoing>SequenceFlow_1wtjwdn</bpmn2:outgoing>
    </bpmn2:startEvent>
    <bpmn2:sequenceFlow id="SequenceFlow_1wtjwdn" sourceRef="StartEvent_1" targetRef="Task_microservice" />
    <bpmn2:serviceTask id="Task_microservice" name="消息队列" camunda:delegateExpression="${messageService}">
      <bpmn2:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="service">MICROSERVICE</camunda:inputParameter>
          <camunda:inputParameter name="function">/callback</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn2:extensionElements>
      <bpmn2:incoming>SequenceFlow_1wtjwdn</bpmn2:incoming>
      <bpmn2:outgoing>SequenceFlow_00eawi8</bpmn2:outgoing>
    </bpmn2:serviceTask>
    <bpmn2:serviceTask id="Task_huidiao" name="回调事件" camunda:delegateExpression="${microService}">
      <bpmn2:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="service">MICROSERVICE</camunda:inputParameter>
          <camunda:inputParameter name="function">/hello</camunda:inputParameter>
          <camunda:inputParameter name="name">wangliang</camunda:inputParameter>
          <camunda:inputParameter name="age">30</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn2:extensionElements>
      <bpmn2:incoming>SequenceFlow_0sbofn7</bpmn2:incoming>
      <bpmn2:outgoing>SequenceFlow_08nmwm5</bpmn2:outgoing>
    </bpmn2:serviceTask>
    <bpmn2:exclusiveGateway id="ExclusiveGateway_0nqijhg">
      <bpmn2:incoming>SequenceFlow_10ga2he</bpmn2:incoming>
      <bpmn2:outgoing>SequenceFlow_0sbofn7</bpmn2:outgoing>
      <bpmn2:outgoing>SequenceFlow_0wppyra</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    <bpmn2:sequenceFlow id="SequenceFlow_0sbofn7" name="pass==ok" sourceRef="ExclusiveGateway_0nqijhg" targetRef="Task_huidiao">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${pass=='ok'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:endEvent id="EndEvent_123oivr">
      <bpmn2:incoming>SequenceFlow_0wppyra</bpmn2:incoming>
      <bpmn2:incoming>SequenceFlow_08nmwm5</bpmn2:incoming>
    </bpmn2:endEvent>
    <bpmn2:sequenceFlow id="SequenceFlow_0wppyra" name="pass==fail" sourceRef="ExclusiveGateway_0nqijhg" targetRef="EndEvent_123oivr">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${pass=='fail'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="SequenceFlow_08nmwm5" sourceRef="Task_huidiao" targetRef="EndEvent_123oivr" />
    <bpmn2:sequenceFlow id="SequenceFlow_00eawi8" sourceRef="Task_microservice" targetRef="Task_mandual" />
    <bpmn2:sequenceFlow id="SequenceFlow_10ga2he" sourceRef="Task_mandual" targetRef="ExclusiveGateway_0nqijhg" />
    <bpmn2:userTask id="Task_mandual" name="手工任务" camunda:assignee="all">
      <bpmn2:extensionElements>
        <camunda:inputOutput>
          <camunda:outputParameter name="pass">${pass}</camunda:outputParameter>
        </camunda:inputOutput>
        <camunda:formData>
          <camunda:formField id="pass" type="string" />
        </camunda:formData>
      </bpmn2:extensionElements>
      <bpmn2:incoming>SequenceFlow_00eawi8</bpmn2:incoming>
      <bpmn2:outgoing>SequenceFlow_10ga2he</bpmn2:outgoing>
    </bpmn2:userTask>
  </bpmn2:process>
  <bpmn2:signal id="Signal_12k82yu" name="Signal_3lvonfs" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_2">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="412" y="240" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1wtjwdn_di" bpmnElement="SequenceFlow_1wtjwdn">
        <di:waypoint x="448" y="258" />
        <di:waypoint x="498" y="258" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_09sht1l_di" bpmnElement="Task_microservice">
        <dc:Bounds x="498" y="218" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0rxxap9_di" bpmnElement="Task_huidiao">
        <dc:Bounds x="964" y="218" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0nqijhg_di" bpmnElement="ExclusiveGateway_0nqijhg" isMarkerVisible="true">
        <dc:Bounds x="796" y="233" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0sbofn7_di" bpmnElement="SequenceFlow_0sbofn7">
        <di:waypoint x="846" y="258" />
        <di:waypoint x="964" y="258" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="881" y="240" width="49" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_123oivr_di" bpmnElement="EndEvent_123oivr">
        <dc:Bounds x="996" y="358" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0wppyra_di" bpmnElement="SequenceFlow_0wppyra">
        <di:waypoint x="821" y="283" />
        <di:waypoint x="821" y="375" />
        <di:waypoint x="996" y="376" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="811" y="326" width="51" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_08nmwm5_di" bpmnElement="SequenceFlow_08nmwm5">
        <di:waypoint x="1014" y="298" />
        <di:waypoint x="1014" y="358" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_00eawi8_di" bpmnElement="SequenceFlow_00eawi8">
        <di:waypoint x="598" y="258" />
        <di:waypoint x="647" y="258" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_10ga2he_di" bpmnElement="SequenceFlow_10ga2he">
        <di:waypoint x="747" y="258" />
        <di:waypoint x="796" y="258" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="UserTask_1i7l7uh_di" bpmnElement="Task_mandual">
        <dc:Bounds x="647" y="218" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>
